declare name "Simulador de Amp Jao 64bit";
declare version "0.1";
declare author "Jao Corporation";
declare description "Simulador de Amp Jao 64bit";

import("stdfaust.lib");

impulso = fi.fir(RESPUESTA_IMPULSO) * (0.2);
mixImpulso = _ <: ( *(1 - impulsoSlider) , impulso *(impulsoSlider) ) : +;

gain = hslider("Gain", 100, 1, 200, 0.1);
prefiltro = hslider("Pasaaltos pre", 1000, 20, 1500, 10);
agudos =  hslider("Parlante (pasabajos)", 3000, 100, 5000, 10);
delaySlider =  hslider("Delay", 0.2, 0, 0.9, 0.01);
blend = hslider("Blend Clean", 2, 0, 10, 0.01);
master =  hslider("Volumen Master", 0.3, 0, 1, 0.01);
impulsoSlider = hslider("IR mix", 0.5, 0, 1, 0.01);

pre = ((fi.highpass(1, prefiltro)) * gain : ma .tanh) / (gain/10 : ma.tanh : *(2));
cleanMezcla = fi.highpass(1, 100) : medios : *(blend);

medios = fi.peak_eq(-15, 1200, 400) : fi.peak_eq(9, 2500, 1000);
delay = @(ma.SR / 3) : *(delaySlider) : fi.lowpass(1, 500);
tono = fi.lowpass(3, agudos);

cadena = _ <: cleanMezcla, (pre : medios) :> tono : + ~ delay : mixImpulso : *(master);

process = cadena <: _, _;

RESPUESTA_IMPULSO = 0.167663574218750,0.569000244140625,0.891204833984375,0.858764648437500,0.591705322265625,0.264221191406250,-0.095092773437500,-0.415100097656250, 
-0.595367431640625,-0.623260498046875,-0.498718261718750,-0.250671386718750,0.040313720703125,0.284973144531250,0.448089599609375,0.456054687500000, 
0.290435791015625,0.086944580078125,-0.002929687500000,0.012512207031250,0.044982910156250,0.053588867187500,0.055358886718750,0.047760009765625, 
0.027191162109375,-0.024291992187500,-0.103546142578125,-0.140716552734375,-0.079162597656250,-0.001373291015625,0.022094726562500,0.022186279296875, 
0.026947021484375,0.001129150390625,-0.052246093750000,-0.071319580078125,-0.014404296875000,0.072631835937500,0.137145996093750,0.161773681640625, 
0.158142089843750,0.131072998046875,0.074981689453125,-0.013397216796875,-0.087402343750000,-0.115142822265625,-0.118835449218750,-0.135070800781250, 
-0.136322021484375,-0.095214843750000,-0.020263671875000,0.043640136718750,0.077514648437500,0.083679199218750,0.086059570312500,0.081817626953125, 
0.058166503906250,0.013183593750000,-0.017303466796875,-0.026489257812500,-0.045013427734375,-0.092071533203125,-0.131072998046875,-0.137420654296875, 
-0.112701416015625,-0.086608886718750,-0.067779541015625,-0.050048828125000,-0.012939453125000,0.015289306640625,0.014801025390625,-0.002288818359375, 
-0.005035400390625,-0.005645751953125,-0.016571044921875,-0.040893554687500,-0.055847167968750,-0.058380126953125,-0.053558349609375,-0.054260253906250, 
-0.045166015625000,-0.027465820312500,-0.010925292968750,-0.013000488281250,-0.021057128906250,-0.027679443359375,-0.033966064453125,-0.058746337890625, 
-0.091644287109375,-0.118927001953125,-0.124053955078125,-0.119506835937500,-0.108001708984375,-0.098327636718750,-0.077178955078125,-0.045654296875000, 
-0.013641357421875,-0.003540039062500,-0.010559082031250,-0.029113769531250,-0.046600341796875,-0.065429687500000,-0.076599121093750,-0.079040527343750, 
-0.069000244140625,-0.059600830078125,-0.046539306640625,-0.032958984375000,-0.017944335937500,-0.015777587890625,-0.026977539062500,-0.046264648437500, 
-0.058105468750000,-0.064178466796875,-0.064941406250000,-0.065155029296875,-0.053192138671875,-0.034576416015625,-0.011566162109375,0.000335693359375, 
0.004577636718750,0.000793457031250,-0.004058837890625,-0.018951416015625,-0.040863037109375,-0.069915771484375,-0.087860107421875,-0.093719482421875, 
-0.084747314453125,-0.070556640625000,-0.049926757812500,-0.031921386718750,-0.019409179687500,-0.014678955078125,-0.008697509765625,-0.001159667968750, 
0.007720947265625,0.009185791015625,0.003570556640625,-0.008575439453125,-0.019470214843750,-0.032562255859375,-0.041961669921875,-0.049468994140625, 
-0.048370361328125,-0.046325683593750,-0.037597656250000,-0.029541015625000,-0.017150878906250,-0.009979248046875,-0.004821777343750,-0.004150390625000, 
0.001281738281250,0.006011962890625,0.013244628906250,0.013885498046875,0.011535644531250,0.001495361328125,-0.011871337890625,-0.029144287109375, 
-0.041198730468750,-0.048248291015625,-0.045562744140625,-0.039031982421875,-0.025177001953125,-0.013153076171875,-0.002136230468750,-0.000427246093750, 
-0.000793457031250,-0.004821777343750,-0.006469726562500,-0.010559082031250,-0.011993408203125,-0.014739990234375,-0.015411376953125,-0.017974853515625, 
-0.018249511718750,-0.021575927734375,-0.023620605468750,-0.028778076171875,-0.029876708984375,-0.030761718750000,-0.025115966796875,-0.019317626953125, 
-0.010192871093750,-0.004882812500000,0.000640869140625,0.000518798828125,0.000061035156250,-0.004913330078125,-0.004608154296875,-0.000976562500000, 
0.009643554687500,0.015655517578125,0.019165039062500,0.016052246093750,0.011352539062500,0.003082275390625,-0.001953125000000,-0.006256103515625, 
-0.002716064453125,-0.001434326171875,0.000671386718750,-0.001739501953125,-0.000762939453125,-0.001525878906250,-0.000701904296875,-0.002960205078125, 
-0.001556396484375,-0.000305175781250,0.003143310546875,0.004516601562500,0.009033203125000,0.012908935546875,0.020019531250000,0.021575927734375, 
0.024322509765625,0.022888183593750,0.024902343750000,0.022003173828125,0.019012451171875,0.011688232421875,0.007202148437500,0.002227783203125, 
0.001251220703125,0.001037597656250,0.006683349609375,0.012786865234375,0.022186279296875,0.026123046875000,0.029663085937500,0.028869628906250, 
0.028808593750000,0.026062011718750,0.025421142578125,0.022888183593750,0.021911621093750,0.016632080078125,0.012237548828125,0.005767822265625, 
0.004364013671875,0.003723144531250,0.006988525390625,0.008239746093750,0.012420654296875,0.014923095703125,0.019348144531250,0.021270751953125, 
0.022918701171875,0.022277832031250,0.021453857421875,0.016387939453125,0.011779785156250,0.004516601562500,0.001037597656250,-0.001922607421875, 
-0.001220703125000,-0.000366210937500,0.003448486328125,0.006835937500000,0.011505126953125,0.012817382812500,0.014251708984375,0.013793945312500, 
0.015563964843750,0.016296386718750,0.017395019531250,0.017761230468750,0.019866943359375,0.021087646484375,0.021606445312500,0.019317626953125, 
0.019195556640625,0.018829345703125,0.020568847656250,0.019317626953125,0.019805908203125,0.019470214843750,0.020996093750000,0.019744873046875, 
0.019561767578125,0.019287109375000,0.021575927734375,0.021209716796875,0.021575927734375,0.019592285156250,0.019866943359375,0.018890380859375, 
0.018981933593750,0.018218994140625,0.020050048828125,0.021057128906250,0.023071289062500,0.021759033203125,0.021575927734375,0.018402099609375, 
0.017944335937500,0.014892578125000,0.014831542968750,0.014587402343750,0.017730712890625,0.020324707031250,0.023773193359375,0.024627685546875, 
0.025543212890625,0.023742675781250,0.023712158203125,0.021484375000000,0.021209716796875,0.019073486328125,0.019317626953125,0.018371582031250, 
0.016876220703125,0.012908935546875,0.010803222656250,0.009429931640625,0.010955810546875,0.009124755859375,0.009704589843750,0.010467529296875, 
0.014587402343750,0.015197753906250,0.015472412109375,0.014587402343750,0.017089843750000,0.016967773437500,0.015533447265625,0.011566162109375, 
0.011260986328125,0.009765625000000,0.007110595703125,0.001464843750000,-0.000183105468750,-0.000244140625000,0.002014160156250,0.000274658203125, 
0.000885009765625,0.003936767578125,0.009368896484375,0.010345458984375,0.008941650390625,0.008483886718750,0.011566162109375,0.012237548828125, 
0.009857177734375,0.006561279296875,0.008605957031250,0.011047363281250,0.010253906250000,0.006317138671875,0.006774902343750,0.009521484375000, 
0.010803222656250,0.007476806640625,0.006683349609375,0.009826660156250,0.015106201171875,0.014038085937500,0.013244628906250,0.013885498046875, 
0.017944335937500,0.016479492187500,0.012817382812500,0.009063720703125,0.010437011718750,0.010559082031250,0.008422851562500,0.005187988281250, 
0.006408691406250,0.008819580078125,0.009979248046875,0.007843017578125,0.008026123046875,0.010131835937500,0.011901855468750,0.009490966796875, 
0.006744384765625,0.005767822265625,0.007934570312500,0.006469726562500,0.003967285156250,0.002899169921875,0.005340576171875,0.006744384765625, 
0.006103515625000,0.003448486328125,0.004821777343750,0.005462646484375,0.004638671875000,0.002044677734375,0.002044677734375,0.003692626953125, 
0.005371093750000,0.003540039062500,0.003479003906250,0.003417968750000,0.003875732421875,0.002319335937500,0.000976562500000,0.000183105468750, 
0.001495361328125,0.000396728515625,0.000366210937500,-0.001342773437500,-0.000640869140625,-0.001068115234375,-0.000915527343750,-0.001922607421875, 
-0.002136230468750,-0.002166748046875,-0.001770019531250,-0.002410888671875,-0.002929687500000,-0.003295898437500,-0.003143310546875,-0.003753662109375, 
-0.003692626953125,-0.004516601562500,-0.003692626953125,-0.003570556640625,-0.003448486328125,-0.002868652343750,-0.002166748046875,-0.001708984375000, 
-0.001159667968750,-0.001098632812500,-0.000793457031250,-0.000976562500000,-0.000915527343750,-0.000854492187500,-0.000274658203125,-0.000549316406250, 
-0.000213623046875,-0.000305175781250,0.000640869140625,0.000030517578125,-0.000274658203125,-0.000854492187500,-0.000518798828125,-0.000915527343750, 
-0.000640869140625,-0.001068115234375,0.000488281250000,0.000640869140625,0.001007080078125,0.000122070312500,0.000061035156250,0.000000000000000, 
-0.000122070312500,-0.000732421875000,-0.001281738281250,-0.001678466796875,-0.001586914062500,-0.002044677734375,-0.002166748046875,-0.002288818359375, 
-0.001647949218750,-0.001586914062500,-0.001922607421875,-0.003112792968750,-0.003692626953125,-0.004577636718750,-0.004882812500000,-0.005950927734375, 
-0.005767822265625,-0.005462646484375,-0.004241943359375,-0.004302978515625,-0.003753662109375,-0.003936767578125,-0.003204345703125,-0.003417968750000, 
-0.003784179687500,-0.004425048828125,-0.004150390625000,-0.004730224609375,-0.004699707031250,-0.005432128906250,-0.005096435546875,-0.005035400390625, 
-0.004608154296875,-0.005004882812500,-0.004425048828125,-0.004760742187500,-0.003967285156250,-0.005157470703125,-0.005157470703125,-0.005950927734375, 
-0.005493164062500,-0.006042480468750,-0.005950927734375,-0.006683349609375,-0.006378173828125,-0.006439208984375,-0.006164550781250,-0.006134033203125, 
-0.005737304687500,-0.005889892578125,-0.005645751953125,-0.006256103515625,-0.006652832031250,-0.006866455078125,-0.006591796875000,-0.006378173828125, 
-0.005706787109375,-0.005645751953125,-0.004516601562500,-0.004241943359375,-0.003936767578125,-0.004577636718750,-0.004730224609375,-0.004943847656250, 
-0.004882812500000,-0.004974365234375,-0.005004882812500,-0.004211425781250,-0.004028320312500,-0.003570556640625,-0.003723144531250,-0.003540039062500, 
-0.002746582031250,-0.002838134765625,-0.002502441406250,-0.002807617187500,-0.002868652343750,-0.002655029296875,-0.002807617187500,-0.003204345703125, 
-0.003082275390625,-0.003356933593750,-0.002899169921875,-0.003417968750000,-0.003326416015625,-0.003723144531250,-0.003112792968750,-0.003723144531250, 
-0.003723144531250,-0.004638671875000,-0.004455566406250,-0.005096435546875,-0.005371093750000,-0.005676269531250,-0.005279541015625,-0.004760742187500, 
-0.004455566406250,-0.004547119140625,-0.004516601562500,-0.004241943359375,-0.004364013671875,-0.004425048828125,-0.004089355468750,-0.003784179687500, 
-0.002960205078125,-0.003540039062500,-0.003143310546875,-0.003875732421875,-0.003570556640625,-0.004333496093750,-0.004425048828125,-0.004730224609375, 
-0.004455566406250,-0.004516601562500,-0.004516601562500,-0.004608154296875,-0.004455566406250,-0.004516601562500,-0.004547119140625,-0.004943847656250, 
-0.004699707031250,-0.004974365234375,-0.004852294921875,-0.005035400390625,-0.004608154296875,-0.004333496093750,-0.003875732421875,-0.003906250000000, 
-0.003631591796875,-0.003570556640625,-0.003356933593750,-0.003814697265625,-0.003417968750000,-0.004028320312500,-0.003601074218750,-0.003997802734375, 
-0.003906250000000,-0.003875732421875,-0.003417968750000,-0.003234863281250,-0.002929687500000,-0.002593994140625,-0.002502441406250,-0.002136230468750, 
-0.002807617187500,-0.002563476562500,-0.003356933593750,-0.002532958984375,-0.002777099609375,-0.002197265625000,-0.001770019531250,-0.001373291015625, 
-0.000640869140625,-0.000885009765625,-0.000427246093750,-0.000610351562500,-0.000518798828125,-0.000823974609375,-0.001586914062500,-0.001434326171875, 
-0.001800537109375,-0.001678466796875,-0.001556396484375,-0.001586914062500,-0.001007080078125,-0.001220703125000,-0.001159667968750,-0.001098632812500, 
-0.001098632812500,-0.000946044921875,-0.001007080078125,-0.001220703125000,-0.001281738281250,-0.001617431640625,-0.002197265625000,-0.002258300781250, 
-0.002380371093750,-0.001617431640625,-0.001098632812500,-0.000610351562500,-0.000427246093750,-0.000915527343750,-0.000976562500000,-0.001342773437500, 
-0.001739501953125,-0.001068115234375,-0.001129150390625,-0.000152587890625,-0.000061035156250,-0.000549316406250,-0.000488281250000,-0.001129150390625, 
-0.001007080078125,-0.001312255859375,-0.001403808593750,-0.000885009765625,-0.001129150390625,-0.001098632812500,-0.001770019531250,-0.001922607421875, 
-0.001647949218750,-0.001434326171875,-0.000976562500000,-0.000976562500000,-0.000854492187500,-0.001159667968750,-0.001495361328125,-0.001800537109375, 
-0.002105712890625,-0.002288818359375,-0.001861572265625,-0.002136230468750,-0.001312255859375,-0.001861572265625,-0.002075195312500,-0.002075195312500, 
-0.002044677734375,-0.001068115234375,-0.000549316406250,0.000091552734375,0.000701904296875,0.000549316406250,0.000915527343750,-0.000091552734375, 
-0.000152587890625,-0.000946044921875,-0.000091552734375,0.000030517578125,0.001037597656250,0.000732421875000,0.000610351562500,0.000152587890625, 
-0.000091552734375,-0.000610351562500,-0.000518798828125,-0.000549316406250,0.000274658203125,0.000183105468750,0.000823974609375,0.000946044921875, 
0.000915527343750,0.000701904296875,-0.000122070312500,-0.000061035156250,-0.000152587890625,0.000213623046875,-0.000061035156250,-0.000061035156250, 
-0.000518798828125,-0.000885009765625,-0.000823974609375,-0.000549316406250,-0.000122070312500,0.000488281250000,0.000701904296875,0.001068115234375, 
0.000854492187500,0.000335693359375,0.000488281250000,-0.000091552734375,0.000305175781250,-0.000305175781250,-0.000030517578125,0.000122070312500, 
0.000396728515625,0.000427246093750,0.000640869140625,0.000671386718750,0.000885009765625,0.000335693359375,0.000549316406250,0.000335693359375, 
0.000762939453125,0.000427246093750,0.000976562500000,0.000549316406250,0.000823974609375,-0.000213623046875,-0.000579833984375,-0.001037597656250, 
-0.000640869140625,-0.000518798828125,0.000366210937500,0.000000000000000,0.000244140625000,-0.000396728515625,-0.000274658203125,-0.000183105468750, 
-0.000244140625000,-0.000152587890625,-0.000274658203125,0.000091552734375,0.000305175781250,0.000946044921875,0.000549316406250,0.000549316406250, 
-0.000396728515625,-0.000366210937500,0.000152587890625,0.000610351562500,0.000732421875000,0.000640869140625,0.000549316406250,0.000732421875000, 
0.000823974609375,0.000518798828125,0.001007080078125,0.000823974609375,0.001098632812500,0.001159667968750,0.001342773437500,0.001586914062500, 
0.001403808593750,0.000854492187500,0.000854492187500,0.000823974609375,0.000488281250000,0.000946044921875,0.000671386718750,0.001708984375000, 
0.001251220703125,0.001281738281250,0.000671386718750,0.000640869140625,0.000671386718750,0.000549316406250,0.000732421875000,0.001190185546875, 
0.001068115234375,0.001129150390625,0.000762939453125,0.000488281250000,0.000701904296875,0.000274658203125,0.000305175781250,0.000335693359375, 
0.000457763671875,0.000396728515625,0.000549316406250,0.000396728515625,0.000610351562500,0.000579833984375,0.000732421875000,0.000305175781250, 
0.000885009765625,0.000335693359375,0.000640869140625,0.000244140625000,0.000213623046875,0.000457763671875,0.000427246093750,0.000640869140625, 
0.000427246093750,0.000701904296875,0.000732421875000,0.000701904296875,0.000244140625000,0.000213623046875,0.000152587890625,0.000091552734375, 
-0.000030517578125,-0.000244140625000,0.000244140625000,0.000183105468750,0.000061035156250,-0.000427246093750,-0.000274658203125,-0.000091552734375, 
-0.000061035156250,-0.000183105468750,0.000061035156250,0.000305175781250,0.000671386718750,0.000122070312500,0.000030517578125,-0.000061035156250, 
-0.000122070312500,-0.000091552734375,-0.000579833984375,-0.000030517578125,-0.000122070312500,0.000335693359375,-0.000122070312500,0.000244140625000, 
0.000518798828125,0.000915527343750,0.000915527343750,0.000366210937500,0.000488281250000,0.000213623046875,0.000030517578125,-0.000183105468750, 
-0.000579833984375,0.000213623046875,0.000579833984375,0.000579833984375,0.000823974609375,0.000518798828125,0.000976562500000,0.000518798828125, 
0.000213623046875,-0.000122070312500,0.000213623046875,0.000244140625000,0.000183105468750,0.000122070312500,0.000091552734375,0.000549316406250, 
0.000152587890625,0.000274658203125,0.000061035156250,0.000274658203125,0.000579833984375,-0.000152587890625,0.000244140625000,-0.000213623046875, 
0.000000000000000,-0.000183105468750,-0.000549316406250,-0.000549316406250,-0.000244140625000,-0.000579833984375,-0.000091552734375,-0.000823974609375, 
-0.000122070312500,-0.000335693359375,-0.000244140625000,-0.000366210937500,-0.000549316406250,-0.000518798828125,-0.000061035156250,-0.000427246093750, 
-0.000183105468750,-0.000366210937500,-0.000122070312500,-0.000396728515625,-0.000366210937500,-0.000915527343750,-0.000335693359375,-0.000762939453125, 
-0.000183105468750,-0.000762939453125,-0.000061035156250,-0.000579833984375,0.000122070312500,-0.000549316406250,0.000000000000000,-0.000488281250000, 
0.000122070312500,-0.000518798828125,-0.000061035156250,-0.000518798828125,-0.000244140625000,-0.000366210937500,-0.000244140625000,-0.000183105468750, 
-0.000213623046875,-0.000061035156250,-0.000335693359375,-0.000305175781250,-0.000366210937500,-0.000335693359375,-0.000244140625000,-0.000213623046875, 
-0.000244140625000,-0.000152587890625,-0.000152587890625,-0.000305175781250,-0.000274658203125,-0.000457763671875,-0.000335693359375,-0.000396728515625, 
-0.000274658203125,-0.000366210937500,-0.000427246093750,-0.000274658203125,-0.000579833984375,-0.000366210937500,-0.000518798828125,-0.000335693359375, 
-0.000366210937500,-0.000335693359375,-0.000305175781250,-0.000518798828125,-0.000366210937500,-0.000549316406250,-0.000427246093750,-0.000488281250000, 
-0.000427246093750,-0.000488281250000,-0.000518798828125,-0.000457763671875,-0.000488281250000,-0.000549316406250,-0.000244140625000,-0.000701904296875, 
-0.000152587890625,-0.000762939453125,-0.000274658203125,-0.000732421875000,-0.000457763671875,-0.000671386718750,-0.000427246093750,-0.000610351562500, 
-0.000274658203125,-0.000579833984375,-0.000152587890625,-0.000518798828125,-0.000213623046875,-0.000488281250000,-0.000335693359375,-0.000518798828125, 
-0.000488281250000,-0.000518798828125,-0.000518798828125,-0.000488281250000,-0.000488281250000,-0.000366210937500,-0.000549316406250,-0.000305175781250, 
-0.000549316406250,-0.000396728515625,-0.000488281250000,-0.000427246093750,-0.000549316406250,-0.000396728515625,-0.000549316406250,-0.000488281250000, 
-0.000488281250000,-0.000671386718750,-0.000366210937500,-0.000579833984375,-0.000549316406250,-0.000396728515625,-0.000610351562500,-0.000457763671875, 
-0.000457763671875,-0.000640869140625;
